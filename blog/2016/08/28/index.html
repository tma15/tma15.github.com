<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>AdaBoostからLarge Margin Distribution Machineの流れ</title>

 	
	<link href="/css/journal.css" rel="stylesheet">

 	
 	<link href="/css/style.css" rel="stylesheet">

    <link rel="alternate" type="application/atom+xml"  href="http://tma15.github.io/blog/index.xml" >
</head>
<body lang="en">
	<div class="container">
		<div class="row">
			<div class="navbar navbar-default navbar-inverse" role="navigation">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="http://localhost:1313/">Now is better than never.</a> 
				</div>
				<div class="navbar-collapse collapse navbar-responsive-collapse">
					<ul class="nav navbar-nav navbar-right">
						<li><a href="http://localhost:1313/">Home</a></li>
						<li><a href="http://localhost:1313//about/">About</a></li>
						<li><a href="http://localhost:1313//blog/">Blog</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>


<div class="container">	
	<div class="row">
		<div class="col-md-offset-1 col-md-10">
			<h3>AdaBoostからLarge Margin Distribution Machineの流れ</h3>
				<span class="label label-primary">Sun Aug 28, 2016</span> in 
				 using tags 			 
				
					
					<a href="/tags/machine_learning">machine_learning</a>
				
			</small>
		</div>
	</div>
	<div class="row">
		<div class="col-md-offset-1 col-md-10">
			<br>
			

<p>AdaBoostはKaggleなどのコンペで良い成績を出しているアンサンブル学習手法の一つである。このエントリはまずAdaBoostの概要および、なぜAdaBoostが高い汎化能力を示しやすいのかをまとめる。汎化能力が出やすい理由を調査することで、Large Margin Distribution Machineへと発展していった、という経緯を俯瞰することを目的とする。</p>

<p>具体的には<a href="http://cs.nju.edu.cn/zhouzh/">Zhi-Hua Zhou</a>先生のスライド (<a href="http://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/Adaboost2LDM.pdf">From AdaBoost to LDM</a>) を眺めて、自分の理解のためにメモとして残したものになっている。</p>

<h2 id="adaboost:6f46916486ef6d372bfe0b46613e634e">AdaBoost</h2>

<p>学習時は、学習データに対して重要度の分布を考慮する。反復的に重要度を使って弱学習器を学習し、T個の学習器を作成する (弱学習器はランダムよりは良い性能であるような分類器)。サンプルに対して現在のラウンドの弱学習器が間違えたサンプルほど重要度が高くなるように分布を更新して、次のラウンドの学習に用いる。まとめると、AdaBoostの学習は次のような流れになる:</p>

<pre><code>Initialize: 分布D_0をセットする
以下の処理をT回繰り返す:
1. 分布D_tを用いて弱学習器h_tを学習する
2. h_tの信頼度a_tを計算する
3. 次のラウンドの分布D_{t+1}を計算する
</code></pre>

<p>予測時は、T個の弱学習器を信頼度aで重み付けした弱学習器$h_t$の線形結合によってサンプル$x$ ($\mathbf{x} \in \mathcal{R}^d$) のラベル$y$ ($y \in {-1, +1}$) を予測する:</p>

<p>$$
y = sign(\sum_{t=1}^{T}(a_t h_t(\mathbf{x}))).
$$</p>

<h3 id="なぜadaboostは良いのか:6f46916486ef6d372bfe0b46613e634e">なぜAdaBoostは良いのか</h3>

<ol>
<li>実装が簡単な割に高い予測性能である事が多い</li>
<li>亜種が色々提案されている (分類、回帰、ランキングなど色々なタスクに適用できる)</li>
<li>経験誤差がブースティングの反復回数に対して指数的に減少することが理論的に保証される</li>
</ol>

<h3 id="汎化誤差:6f46916486ef6d372bfe0b46613e634e">汎化誤差</h3>

<p>汎化誤差は、ブースティングの反復回数に応じて増加することが証明されている (Freund &amp; Schapire, 97) 。つまり、ブースティングの反復回数を増やすと、過学習を起こしやすいということである。</p>

<p>しかしながら、実験的には過学習はあまり起きない。なぜ過学習が起きにくいのか、これは重要な疑問である。</p>

<h2 id="adaboostの主な研究:6f46916486ef6d372bfe0b46613e634e">AdaBoostの主な研究</h2>

<p>ここでは主に研究のフォーカスが当てられている二つトピックを挙げる:</p>

<ul>
<li>Statistical view</li>
<li>Margin theory</li>
</ul>

<h3 id="statistical-view:6f46916486ef6d372bfe0b46613e634e">Statistical view</h3>

<p>弱学習器の重み付き足し算$H(x)=\sum a_t h_t(x)$に対してロジスティック関数を考えて、確率$p(f(\mathbf{x})=1|x)= \exp(H(x))/( \exp(H(\mathbf{x})) + \exp(-H(\mathbf{x})))$を推定することを考えると、負の対数尤度を最大化する最適化問題として捉えることが出来る ($f(\mathbf{x}) \in {-1, 1})$)。</p>

<p>なぜ過学習しにくいのかは説明できない。
サイズが大きな決定木 (複雑なモデル) ほど過学習しやすい、という話があるが、サイズが大きな決定木を弱学習器としたほうが良い結果になっている。</p>

<h3 id="margin-theory:6f46916486ef6d372bfe0b46613e634e">Margin theory</h3>

<p>マージンは超平面からの距離であり、大きいほど分類器が自信を持っているとみなせる。</p>

<p>(Schapire+, 98)はAdaBoostの汎化誤差は（他の変数を固定すると）学習データのマージンが大きいほど小さくなる、ということを証明した。そのためMargin theoryは過学習が起きにくい理由を次のように説明できる:「経験誤差が0になった後も、マージンは大きくなるから」</p>

<p>最小のマージンが大きいほど、誤り率は小さくなる。よって、最小のマージンを考えることによって、BreimanはSchapireらよりも低い、汎化誤差の上限を証明した。</p>

<h2 id="margin-theoryの疑問:6f46916486ef6d372bfe0b46613e634e">Margin theoryの疑問</h2>

<p>(Breiman, 99)はarc-gvを提案した。arc-gvは最小のマージンを直接最大化する手法である。つまり、arc-gvはAdaBoostよりも良い性能であることが期待される。しかしながら、AdaBoostとの比較実験から次のことが分かった:</p>

<ul>
<li>arc-gvはAdaBoostより一様に大きい最小マージンを作る</li>
<li>ほぼすべての場合において汎化誤差はAdaBoostよりも増加する</li>
</ul>

<p>そのためBreimanはこのMargin theoryは疑わしいという結論に至り、このmargin theoryは廃れることになる。</p>

<h3 id="それから7年後:6f46916486ef6d372bfe0b46613e634e">それから7年後</h3>

<p>(Reyzin &amp; Schapire, 06)はBreimanは実験においてモデルの複雑性をうまくコントロールしていなかったことを見つけた:</p>

<ul>
<li>Breimanは葉の数を固定して決定木 (モデル) の複雑性をコントロールした</li>
<li>Reyzin &amp; Schapireはarc-gvの木がAdaBoostの木よりも深い事が多いことを指摘した</li>
</ul>

<p>Reyzin &amp; SchapireはBreimanの実験を、decision stump (一つの素性の有無で分類をおこなう分類器) を使っておこなった。この実験ではarc-gvはより大きな最小マージンを伴うが、より悪いマージンの分布を伴っていた。</p>

<h3 id="margin-theoryは生き残るのか:6f46916486ef6d372bfe0b46613e634e">Margin theoryは生き残るのか？</h3>

<p>Reyzin &amp; Schapireは最小マージンは重要ではなく、マージンの平均や中央値が重要であると主張した。マージンの分布がより重要であると主張するには、マージンの分布に基づく上限が、最小マージンに基づく上限と同等に低い必要がある。</p>

<p>Reyzin &amp; Schapire以降はmarginの平均と、マージンの分散によって汎化誤差の上限を保証した研究がなされていった。</p>

<ul>
<li>(Wang+, 08)</li>
<li>(Gao &amp; Zhou, 13)</li>
</ul>

<h3 id="新しい知見:6f46916486ef6d372bfe0b46613e634e">新しい知見</h3>

<p>(Gao &amp; Zhou, 13): マージンの平均だけではなく、マージンの分散にも注意を払うべきである。</p>

<h2 id="large-margin-distribution-machine:6f46916486ef6d372bfe0b46613e634e">Large Margin Distribution Machine</h2>

<h3 id="large-marginとlarge-margin-distributionの大きな違い:6f46916486ef6d372bfe0b46613e634e">Large marginとLarge margin distributionの大きな違い</h3>

<p>Large marginは最小マージンを最大化する。Large margin distributionはマージンの平均の最大化およびマージンの分散の最小化を同時におこなってマージンの分布を最適化する。<a href="http://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/Adaboost2LDM.pdf">スライド</a>p.45の例が分かりやすい。
利点として、サポートベクターのみに依存せずに超平面を引ける。また外れ値やノイズに対して敏感になりにくいなどが挙げられる。</p>

<h3 id="定式化と最適化:6f46916486ef6d372bfe0b46613e634e">定式化と最適化</h3>

<p>定式化および最適化については元論文 (<a href="http://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/kdd14ldm.pdf">Large Margin Distribution Machine</a>, KDD 2014)を読んだほうが良いので割愛する。ざっくり言うと、以下の様な定式化をおこなう:</p>

<p>$$
\begin{eqnarray}
\min_{\mathbf{w}} &amp;&amp; \lambda_1 \hat{\gamma} - \lambda_2 \bar{\gamma}, \\
\textrm{s.t.} &amp;&amp; y_i \mathbf{w} \mathbf{x}_i \geq 1, 1 \leq i \leq m.
\end{eqnarray}
$$</p>

<p>ただし、$\bar{\gamma}$はマージンの平均、$\hat{\gamma}$はマージンの分散を表し、$\lambda_1$および$\lambda_2$はそれらの項をどれくらい重視するかを決める定数を表す。</p>

<p>つまり、学習データ$\{(\mathbf{x}_i, y_i)\}_{i=1}^m$
をマージンが1以上で正しく分類するという条件のもと、マージンの平均を大きく、かつマージンの分散が小さくなるような$\mathbf{w}$を見つける、という問題となっている。</p>

<p>この問題を双対問題化することによってラグランジュの未定乗数を閉形式で求めることができ、その手法をKernel Large Margin Distribution Machineと呼んでいる。</p>

<h3 id="結果:6f46916486ef6d372bfe0b46613e634e">結果</h3>

<p>複数のデータセットで実験をおこない、Kernel Large Distribution Machineは、カーネル化したSVMよりも良い予測性能を出している。さらに学習時間もLIBLINEARより短く、ハイパーパラメータにも過敏ではない、などの結果も得られている。</p>

<h2 id="まとめ:6f46916486ef6d372bfe0b46613e634e">まとめ</h2>

<ul>
<li>AdaBoostの汎化能力はマージンを大きくすることによって高くなる</li>
<li>arc-gvの失敗を分析して、最小マージンを大きくするのではなく、マージンの分散を小さくする方が良いことが分かった</li>
<li>Large Margin Distribution Machineはマージンの平均を大きく、かつマージンの分散を小さくするための手法であり、複数のデータセットにおいて、SVMよりも良い性能を示している</li>
</ul>

		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<hr>
		</div>
	</div>	
        <div id="disqus_thread"></div>
<script type="text/javascript">
     
    var disqus_shortname = 'nowisbetterthannever'; 

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>

  <div class="container">
    <div class="row col-md-12">
          <footer>
            <div>
                <p>
                    &copy; 2014  ~ Powered By <a href="http://hugo.spf13.com">Hugo</a>
                </p>
            </div>
            </footer>
        </div>
    </div>

    
    
    <script src="/js/jquery-min-2.1.1.js"></script>
    <script src="/js/bootstrap.min-3.1.1.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: { inlineMath: [['$','$'],['\\(','\\)']] }
        });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-20414370-4']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </body>
</html>

